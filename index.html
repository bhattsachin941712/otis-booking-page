<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Book Consultation | Otis Center</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

    body {
      font-family: 'Inter', sans-serif;
      background: #121212;
      margin: 0;
      padding: 0;
      color: #f1f1f1;
    }

    .container {
      width: 90%;
      max-width: 500px;
      margin: 50px auto;
      background: #1e1e1e;
      padding: 35px;
      border-radius: 16px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.8);
    }

    .brand-header {
      text-align: center;
      margin-bottom: 20px;
    }

    .brand-name {
      font-size: 26px;
      font-weight: 700;
      color: #ffffff;
    }

    h1 {
      text-align: center;
      color: #ffffff;
      font-size: 28px;
      margin-bottom: 10px;
    }

    .subtitle {
      text-align: center;
      color: #aaaaaa;
      font-size: 15px;
      margin-bottom: 25px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #eeeeee;
    }

    select,
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="date"],
    textarea {
      width: 100%;
      padding: 12px 14px;
      border-radius: 8px;
      border: 1px solid #333333;
      margin-bottom: 18px;
      font-size: 14px;
      background-color: #2a2a2a;
      color: #ffffff;
      box-sizing: border-box;
      transition: border-color 0.3s, background-color 0.3s;
    }

    select:focus,
    input:focus,
    textarea:focus {
      border-color: #3498db;
      background-color: #333333;
      outline: none;
    }

    textarea {
      resize: vertical;
    }

    .btn {
      display: inline-block;
      background-color: #3498db;
      color: #ffffff;
      text-align: center;
      padding: 15px;
      width: 100%;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
      text-decoration: none;
    }

    .btn:hover {
      background-color: #217dbb;
      transform: translateY(-2px);
    }

    .privacy-note {
      font-size: 12px;
      color: #888888;
      margin-top: 20px;
      text-align: center;
      line-height: 1.5;
    }

    footer {
      text-align: center;
      font-size: 12px;
      margin-top: 30px;
      color: #555555;
    }

    small {
      display: block;
      margin-top: -14px;
      margin-bottom: 15px;
      font-size: 12px;
      color: #888888;
    }

    #form-message {
      text-align: center;
      margin-top: 15px;
      color: #4CAF50;
      font-size: 14px;
    }
  </style>
</head>

<body>

  <div class="container">

    <div class="brand-header">
      <div class="brand-name">Otis Center</div>
    </div>

    <h1>Book Your Private Consultation</h1>
    <p class="subtitle">100% Confidential | Certified Sexologists</p>

    <form id="consultation-form">

      <label for="consultation">Consultation Type</label>
      <select id="consultation" name="Consultation Type" required>
        <option value="">-- Select Consultation Type --</option>
        <option value="Audio Consultation">On Call Consultation</option>
        <option value="Video Consultation">Video Call Consultation</option>
      </select>

      <label for="ageGroup">Select Your Age Group</label>
      <select id="ageGroup" name="Age Group" required>
        <option value="">-- Select Age Group --</option>
        <option value="Under 18">Under 18</option>
        <option value="18-24">18 - 24</option>
        <option value="25-34">25 - 34</option>
        <option value="35-44">35 - 44</option>
        <option value="45-54">45 - 54</option>
        <option value="55+">55+</option>
      </select>

      <!-- New Preferred Language field -->
      <label for="language">Preferred Language of Consultation</label>
      <select id="language" name="Preferred Language" required>
        <option value="">-- Select Language --</option>
        <option value="English">English</option>
        <option value="Hindi">Hindi</option>
        <option value="Marathi">Marathi</option>
        <option value="Tamil">Tamil</option>
        <option value="Telugu">Telugu</option>
        <option value="Kannada">Kannada</option>
        <option value="Gujarati">Gujarati</option>
        <option value="Punjabi">Punjabi</option>
        <option value="Bengali">Bengali</option>
        <option value="Malayalam">Malayalam</option>
        <option value="Other">Other</option>
      </select>

      <label for="duration">Select Duration & Fee</label>
      <select id="duration" name="Time Slot Duration" required onchange="updateTimeSlots()">
        <option value="">-- Select Time Slot --</option>
        <option value="15 Minutes - â‚¹300">15 Minutes - â‚¹300</option>
        <option value="30 Minutes - â‚¹500">30 Minutes - â‚¹500</option>
        <option value="1 Hour - â‚¹1000">1 Hour - â‚¹1000</option>
      </select>

      <label for="date">Preferred Date</label>
      <input type="date" id="date" name="Preferred Date" required onchange="updateTimeSlots()">

      <label for="timeslot">Preferred Time Slot</label>
      <select id="timeslot" name="Preferred Time Slot" required>
        <option value="">-- Select Duration First --</option>
      </select>

      <label for="name">Your Name (Alias Allowed)</label>
      <input type="text" id="name" name="Name" placeholder="Enter your name" required>

      <label for="whatsapp">WhatsApp Number (10 digits only)</label>
      <input type="tel" id="whatsapp" name="WhatsApp Number" pattern="[0-9]{10}" maxlength="10"
        placeholder="Enter 10-digit number" required>
      <small>Enter your 10-digit WhatsApp number (without country code).</small>

      <label for="email">Email Address</label>
      <input type="email" id="email" name="Email" placeholder="example@mail.com" required>

      <label for="message">Describe Your Concern (Optional)</label>
      <textarea id="message" name="Concern" rows="4" placeholder="Write a brief concern (optional)..."></textarea>

      <button type="submit" class="btn">Submit & Proceed</button>
    </form>

    <div id="form-message"></div>

    <p class="privacy-note">
      ðŸ”’ Your privacy is our priority.<br>
      All data is encrypted & consultations are fully confidential.
    </p>
  </div>

  <footer>
    Â© 2025 Otis Center. All rights reserved.
  </footer>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwY8gtng_gNttFCKvr6kxejuc_oMAqvJ3LYksuPFPtiOYRrMKI-XAMAY7lGA2IfnpSW1Q/exec';
    const form = document.getElementById('consultation-form');
    const formMessage = document.getElementById('form-message');
    const submitButton = form.querySelector('button[type="submit"]');

    const dateInput = document.getElementById('date');
    const today = new Date().toISOString().split('T')[0];
    dateInput.setAttribute('min', today);

    const paymentLinks = {
      "15 Minutes - â‚¹300": "https://razorpay.me/@otiscenter?amount=JRabBs%2BUijZmruPWP7O7uQ%3D%3D",
      "30 Minutes - â‚¹500": "https://razorpay.me/@otiscenter?amount=bd6mwPoVV2sRePhB8DGUcw%3D%3D",
      "1 Hour - â‚¹1000": "https://razorpay.me/@otiscenter?amount=LaORF0cOqXzXsYKdgu1fsg%3D%3D"
    };

    form.addEventListener('submit', e => {
      e.preventDefault();

      submitButton.disabled = true;
      submitButton.innerText = 'Submitting...';

      const formData = new FormData(form);
      const params = new URLSearchParams();

      for (const pair of formData.entries()) {
        params.append(pair[0], pair[1]);
      }

      const selectedDuration = form.querySelector('#duration').value;
      const redirectLink = paymentLinks[selectedDuration] || "#";

      fetch(scriptURL, {
        method: 'POST',
        body: params
      })
        .then(response => response.json())
        .then(response => {
          if (response.result === 'success') {
            formMessage.style.color = "#4CAF50";
            formMessage.innerHTML = "âœ… Details submitted! Redirecting you to payment...";
            setTimeout(() => {
              window.location.href = redirectLink;
            }, 2000);
          } else {
            formMessage.style.color = "#FF5252";
            formMessage.innerHTML = "âŒ Submission failed. Please try again!";
            submitButton.disabled = false;
            submitButton.innerText = 'Submit & Proceed';
          }
        })
        .catch(error => {
          formMessage.style.color = "#FF5252";
          formMessage.innerHTML = "âŒ There was an error! Please try again.";
          console.error('Error!', error.message);
          submitButton.disabled = false;
          submitButton.innerText = 'Submit & Proceed';
        });
    });

    function updateTimeSlots() {
      const durationSelect = document.getElementById('duration');
      const timeslotSelect = document.getElementById('timeslot');
      const dateSelect = document.getElementById('date').value;

      timeslotSelect.innerHTML = '';

      const selectedDuration = durationSelect.value;

      if (!selectedDuration || !dateSelect) {
        const option = document.createElement('option');
        option.text = '-- Select Duration First --';
        timeslotSelect.appendChild(option);
        return;
      }

      const now = new Date();
      const selectedDate = new Date(dateSelect);
      let slots = [];

      let currentHour = now.getHours();
      let currentMinute = now.getMinutes();

      let minTimeInMinutes = (selectedDate.toDateString() === now.toDateString()) ? (currentHour * 60 + currentMinute + 15) : (9 * 60);

      if (selectedDuration.includes('15 Minutes')) {
        slots = generateTimeSlots(15, minTimeInMinutes);
      } else if (selectedDuration.includes('30 Minutes')) {
        slots = generateTimeSlots(30, minTimeInMinutes);
      } else if (selectedDuration.includes('1 Hour')) {
        slots = generateTimeSlots(60, minTimeInMinutes);
      }

      if (slots.length > 0) {
        slots.forEach(function (slot) {
          const option = document.createElement('option');
          option.value = slot;
          option.text = slot;
          timeslotSelect.appendChild(option);
        });
      } else {
        const option = document.createElement('option');
        option.text = '-- No slots available --';
        timeslotSelect.appendChild(option);
      }
    }

    function generateTimeSlots(intervalMinutes, minTimeInMinutes = 9 * 60) {
      const startHour = 9;
      const endHour = 20;
      let slots = [];

      for (let hour = startHour; hour < endHour; hour++) {
        let minutes = 0;
        while (minutes < 60) {
          let totalMinutes = hour * 60 + minutes;

          if (totalMinutes < minTimeInMinutes) {
            minutes += intervalMinutes;
            continue;
          }

          let startTime = formatTime(hour, minutes);
          let endMinutes = minutes + intervalMinutes;
          let endHourAdjusted = hour;

          if (endMinutes >= 60) {
            endMinutes = endMinutes % 60;
            endHourAdjusted = hour + 1;
          }

          if (endHourAdjusted >= endHour && endMinutes > 0) break;

          let endTime = formatTime(endHourAdjusted, endMinutes);
          slots.push(`${startTime} - ${endTime}`);

          minutes += intervalMinutes;
        }
      }
      return slots;
    }

    function formatTime(hour, minute) {
      const ampm = hour >= 12 ? 'PM' : 'AM';
      const hour12 = hour % 12 === 0 ? 12 : hour % 12;
      const minuteStr = minute < 10 ? '0' + minute : minute;
      return `${hour12}:${minuteStr} ${ampm}`;
    }
  </script>

</body>

</html>
